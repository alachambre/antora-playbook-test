<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How to configure Amazon Web Services (AWS) for BCD :: Bonita documentation 2.0</title>
    <link rel="canonical" href="http://localhost:8080/documentation/bcd/3.4/aws_prerequisites.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.css"
    />
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="bonita-logo" href="http://localhost:8080/documentation"></a>
      <a class="navbar-item" href="http://localhost:8080/documentation">Bonita documentation 2.0</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

          <input type="text" placeholder="Search Docs" class="query ds-input" id="search-query">

          <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js"></script>
          <script>
            docsearch({
              // Your apiKey and indexName will be given to you once
              // we create your config
              apiKey: '8b16fe941025bb59db192dce337bc486',
              indexName: 'test_BONITA',
              appId: 'LMVLEZKT54', // Should be only included if you are running DocSearch on your own.
              // Replace inputSelector with a CSS selector
              // matching your search input
              inputSelector: '#search-query',
              // Set debug to true to inspect the dropdown
              debug: false,
              algoliaOptions: {
                'facetFilters': ["tags:3.4", "tags:bcd"]
              },
            });
          </script>

            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Bonita</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" href="../../bonita/7.12/index.html">7.12</a>
                  <a class="navbar-item" href="../../bonita/7.11/index.html">7.11</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Bonita Continous Delivery</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" href="index.html">3.4</a>
              </div>
            </div>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" href="#">Bonita REST API</a>
              <div class="navbar-dropdown">
                  <a class="navbar-item" href="../../bonitaAPI/7.12/index.html">7.12</a>
              </div>
            </div>
      </div>
    </div>

  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bcd" data-version="3.4">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Bonita Continous Delivery</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="release_notes.html">Release notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="requirements-and-compatibility.html">Requirements and compatibility</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="getting_started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="upgrade_bcd.html">Upgrade BCD</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#_bcd_services_and_scenarios.adoc">BCD services and scenarios</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bcd_controller.html">Controller Docker image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bcd_cli.html">Command-line interface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scenarios.html">Scenario file reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#_howtos.adoc">Howtos</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#_manage_stack.adoc">Manage Bonita stacks</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="aws_prerequisites.html">Configure Amazon Web Services (AWS) for BCD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="aws_sso.html">Configure AWS single sign-on</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="aws_organizations.html">Assume IAM role within AWS Organizations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="azure-prerequisites.html">Configure Microsoft Azure for BCD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="deploy_with_static_inventory.html">Deploy with a static inventory</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="deploy-with-existing-database.html">Deploy with an existing database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#_custom_init.adoc">Customize the Bonita container</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="custom_init.html">Using initialization scripts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="how_to_configure_rest_api_authorization.html">Configuring REST API authorization</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="how_to_enable_remote_monitoring_jmx.html">Enabling remote monitoring with JMX</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="manage_bonita_licenses.html">Manage Bonita licenses</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#_manage_living_application.adoc">Manage Bonita Living Applications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="livingapp_build.html">Build a Living App repository</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="livingapp_manage_configuration.html">Manage Living App configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="livingapp_deploy.html">Deploy Living App artifacts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="livingapp_build_and_deploy.html">Build and deploy (Best Practices)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="how_to_use_bcd_with_data_encrypted.html">Use BCD with sensitive data encrypted</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jenkins_example.html">Integrate BCD with Jenkins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting_guide.html">Troubleshooting guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Bonita Continous Delivery</span>
    <span class="version">3.4</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Bonita</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../bonita/7.12/index.html">7.12</a>
        </li>
        <li class="version">
          <a href="../../bonita/7.11/index.html">7.11</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Bonita Continous Delivery</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">3.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Bonita REST API</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../bonitaAPI/7.12/index.html">7.12</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../bonita/7.12/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Bonita Continous Delivery</a></li>
    <li><a href="#_howtos.adoc">Howtos</a></li>
    <li><a href="#_manage_stack.adoc">Manage Bonita stacks</a></li>
    <li><a href="aws_prerequisites.html">Configure Amazon Web Services (AWS) for BCD</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/alachambre/antora-sources-test-2/edit/master/modules/ROOT/pages/aws_prerequisites.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">How to configure Amazon Web Services (AWS) for BCD</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial describes how to configure Amazon Web Services (AWS) for BCD.
+ These configuration steps are required to allow BCD to programmatically manage your AWS instances and to be able to connect to your Bonita stack.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sign_up_for_aws"><a class="anchor" href="#_sign_up_for_aws"></a>Sign Up for AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you do not have an Amazon Web Services account yet, first sign up as described in this AWS user guide: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/get-set-up-for-amazon-ec2.html#sign-up-for-aws">Sign Up for AWS</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aws_setup_for_bcd"><a class="anchor" href="#_aws_setup_for_bcd"></a>AWS Setup for BCD</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to use Amazon EC2 instances, some configuration steps need to be performed as a prerequisite.
+ The following steps are the basic requirements to set up AWS credentials for Ansible automation.
+ Further configuration instructions for <strong>AWS single sign-on</strong> can be found <a href="aws_sso.html" class="page">on this page</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_create.html">Create an IAM Policy</a> to grant full access to Amazon EC2 on a specific region (eg.
us-west-2)</p>
<div class="ulist">
<ul>
<li>
<p><strong>Policy name</strong>: EC2FullAccess_us-west-2</p>
</li>
<li>
<p><strong>Policy document</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> {
  "Version": "2012-10-17",
  "Statement": [
      {
          "Action": "ec2:*",
          "Effect": "Allow",
          "Resource": "*",
          "Condition": {
              "StringEquals": {
                  "ec2:Region": "us-west-2"
              }
          }
      }
  ]
 }</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Create an IAM Policy to give <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_passrole.html">PassRole</a> permission in order to be able to associate a specific role with the EC2 instances of a cluster.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Policy name</strong>: IAMPassRole</p>
</li>
<li>
<p><strong>Policy document</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> {
  "Version": "2012-10-17",
  "Statement": [
      {
          "Action": "iam:PassRole",
          "Effect": "Allow",
          "Resource": "*"
      }
  ]
 }</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_create.html">Create an IAM Group</a></p>
<div class="ulist">
<ul>
<li>
<p><strong>Group name</strong>: bonita-provisioning</p>
</li>
<li>
<p>Select the IAM Policies created previously</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>For some usage you may be interested to create a role and attach to it the corresponding policies, see <a href="aws_sso.html" class="page">Configure AWS single sign-on</a> or <a href="aws_organizations.html" class="page">Assume IAM role within AWS Organizations</a>.</em></p>
</div>
</li>
<li>
<p>Create an IAM Policy to allow ec2 instances of a cluster to autodiscover themselves on a specific region (eg.
us-west-2).</p>
<div class="ulist">
<ul>
<li>
<p><strong>Policy name</strong>: ClusterBCD_us-west-2</p>
</li>
<li>
<p><strong>Policy document</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> {
  "Version": "2012-10-17",
  "Statement": [
      {
          "Action": [
              "ec2:DescribeInstances"
          ],
          "Effect": "Allow",
          "Resource": "*",
          "Condition": {
              "StringEquals": {
                  "ec2:Region": "us-west-2"
              }
          }
      }
  ]
 }</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"></dt>
<dd>
<p>warning  :fa-exclamation-triangle: Pay attention that for security reasons, pushing AWS user credentials to EC2 instances (as done with BCD 1.0.x) is no longer supported.</p>
</dd>
<dt class="hdlist1"></dt>
</dl>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html">Create an IAM Role for an AWS service</a></p>
<div class="ulist">
<ul>
<li>
<p>Select EC2 to "Allows EC2 instances to call AWS services on your behalf."</p>
</li>
<li>
<p>Select the IAM Policy created previously (ClusterBCD_us-west-2)</p>
</li>
<li>
<p><strong>Role name</strong>: ClusterBCD</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html">Create an IAM User</a></p>
<div class="ulist">
<ul>
<li>
<p><strong>Access type</strong>: Programmatic access</p>
</li>
<li>
<p>Add user to the IAM group created previously</p>
</li>
<li>
<p>Download as .csv (or copy) Access key information (<strong>Access key ID</strong> and <strong>Secret access key</strong>) for later use</p>
</li>
</ul>
</div>
</li>
<li>
<p>Now let&#8217;s assume you are using an EC2 region which supports the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-supported-platforms.html">EC2-VPC platform</a>.
Therefore a <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/default-vpc.html">default VPC and default subnets</a> should already be available.</p>
</li>
<li>
<p><a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html#creating-security-group">Create an EC2 Security Group</a></p>
<div class="ulist">
<ul>
<li>
<p><strong>Security group name</strong>: sg_bonita-provisioning</p>
</li>
<li>
<p>Add an Inbound rule to allow communication between Bonita stack components</p>
<div class="ulist">
<ul>
<li>
<p><strong>Type</strong>: All Traffic, <strong>Source</strong>: &lt;security_group_id_of_sg_bonita-provisioning&gt;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add an Inbound rule to allow Ansible to connect via SSH</p>
<div class="ulist">
<ul>
<li>
<p><strong>Type</strong>: SSH, <strong>Source</strong>: My IP</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add an Inbound rule to allow remote connection to Bonita Tomcat via HTTP</p>
<div class="ulist">
<ul>
<li>
<p><strong>Type</strong>: Custom TCP Rule, <strong>Port Range</strong>: 8081, <strong>Source</strong>: My IP</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add an Inbound rule to allow remote connection to Bonita databases</p>
<div class="ulist">
<ul>
<li>
<p><strong>Type</strong>: Custom TCP Rule, <strong>Source</strong>: My IP</p>
<div class="ulist">
<ul>
<li>
<p>with <code>bonita_db_vendor: postgres</code> - <strong>Port Range</strong>: 5432</p>
</li>
<li>
<p>with <code>bonita_db_vendor: mysql</code> - <strong>Port Range</strong>: 3306</p>
</li>
<li>
<p>with <code>bonita_db_vendor: oracle</code> - <strong>Port Range</strong>: 1521</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">Create an EC2 Key Pair</a></p>
<div class="ulist">
<ul>
<li>
<p><em>Note: A key pair is linked to an AWS region</em></p>
</li>
<li>
<p>Download the <code>.pem</code> private key file</p>
</li>
<li>
<p>Ensure private key file permissions: <code>$ chmod 400 &lt;keyfile_basename&gt;.pem</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>BCD is compatible with official Ubuntu cloud images as EC2 AMI (Amazon Machine Images).
+ Use the <a href="https://cloud-images.ubuntu.com/locator/ec2/">Amazon EC2 AMI Locator</a> tools to identify IDs of such images.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dynamic_ec2_inventory_configuration"><a class="anchor" href="#_dynamic_ec2_inventory_configuration"></a>Dynamic EC2 inventory configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When deploying to AWS, BCD uses <a href="http://docs.ansible.com/ansible/latest/intro_dynamic_inventory.html#example-aws-ec2-external-inventory-script">dynamic Amazon EC2 inventory</a> with a <code>ec2_wrapper.sh</code> script.</p>
</div>
<div class="paragraph">
<p>This <code>ec2_wrapper.sh</code> script can be further configured with the <code>ec2.ini.j2</code> template.</p>
</div>
<div class="paragraph">
<p>For instance, if you are running the BCD controller <strong>from outside EC2</strong>, the <code>vpc_destination_variable</code> parameter should be set to <code>ip_address</code>.
If you are running the BCD controller <strong>from within EC2</strong>, the <code>vpc_destination_variable</code> parameter should be set to <code>private_ip_address</code>.
+ This parameter is managed by the <code>ec2_vpc_destination_variable</code> BCD variable.</p>
</div>
<div class="paragraph">
<p>More information on dynamic EC2 inventory management can be found in <a href="https://aws.amazon.com/blogs/apn/getting-started-with-ansible-and-dynamic-amazon-ec2-inventory-management/">this blog post</a>.</p>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
